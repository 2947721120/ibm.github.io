<!DOCTYPE html>
<!-- saved from url=(0043)http://getbootstrap.com/examples/jumbotron/ -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">


    <title>IBM @ Github</title>

    <link href="http://getbootstrap.com/dist/css/bootstrap.css" rel="stylesheet">

    <link href="http://getbootstrap.com/examples/jumbotron/jumbotron.css" rel="stylesheet">
    <link href="./css/style.css" rel="stylesheet">

  </head>
  <body style="">

    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="container-fluid">
          <a class="navbar-brand" href="http://www.ibm.com"><img src="images/ibmneg_white_42x20.png" alt="IBM"></a>
          <!--a class="navbar-brand" style="float: right" href="http://www.ibm.com/developerworks"><img src="images/dWmark.png" alt="DW"></a-->
          <a id="dw-nav" class="navbar-brand" style="float: right" href="http://www.ibm.com/developerworks" title="developerWorks"><span class="dw-logo-IBM">IBM</span>&nbsp;<span class="dw-logo-d">d</span><span class="dw-logo-W">W</span></a>
        <div class="navbar-header">
        </div>
      </div>
    </div>

    <!-- Main jumbotron for a primary marketing message or call to action -->
    <div class="jumbotron">
      <div class="container">
        <center><h1>IBM Open Source at GitHub</h1>
        </center>
        <center>
        <p class="btn btn-primary btn-lg btn-custom-dw" style="font-family	:'Helvetica Neue'; margin: 30px;">See more IBM OSS content on 
			<br><a href="http://developer.ibm.com/opensource"><span style="color: #fff;font-family: 'Lubalin'">developerWorks »</span></a>
        </p>
        <p class="btn btn-primary btn-lg btn-custom-jazz" style="font-family:'Helvetica Neue'; margin: 30px">Enhance your GitHub experience with 
			<br><a href="http://hub.jazz.net/learn"><span style="color: #fff;font-family: 'Lubalin'">JazzHub »</span></a>        	
        </p>
        </center>
      </div>
    </div>

    <div class="container">
      <div class="row">
		<div class="col-sm-12 col-md-12 col-lg-12">
			<div id="wrapper">
				<label for="search" class="col-lg-4 control-label search" style=""><span style="float:left; padding-top:6px; padding-left: 19px;font-weight: 700">SEARCH</span> <input type="search" id="search" class="search-query span3 filter input-medium" placeholder="OUR REPOS..."></label>
				
				<div id="repos" class="columns collapse-group">
					
				</div>
			</div>
		</div>
	  </div>
	  <hr>
		</div>
      </div>
    </div>
      <footer>
      	 <div class="container">
        <p>© IBM 2013</p>
        </div>
      </footer>
    </div> <!-- /container -->


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="./js/jquery.js"></script>
    <script src="./js/bootstrap.min.js"></script>
      <script type="text/javascript" src="js/strftime.js"></script>
    <script type="text/javascript">
    
    var orgs = [
    	{"name": "wasdev",
    	 "type": "org",
    	 "link": "http://wasdev.github.io/"},
    	 {"name": "acmeair",
    	 "type": "org"},
    	 {"name": "kimchi-project",
    	 "type": "org"},
    	 {"name": "OpenSocial",
    	 "type": "org"},
    	 {"name": "ibmcb",
    	 "type": "user"},
    	 {"name": "node-red",
    	 "type": "org"},
    	 {"name": "ibmjstart",
    	 "type": "org"},    	 
    	 {"name": "openntf",
    	 "type": "org"},
    	 {"name": "ibm-dojo",
    	 "type": "org"},
         {"name": "ibm-bioinformatics",
          "type":"user"},
    	 {"name": "wsadminlib",
    	  "type": "user",
    	 }
    ];
    
    var tags = [
	    {"name" : "big data",
    	"tag" : "bigdata"},
	    {"name" : "business analytics",
    	"tag" : "businessanalytics"},
	    {"name" : "cloud",
    	"tag" : "cloud"},
	    {"name" : "devops",
    	"tag" : "devops"},
	    {"name" : "mobile",
    	"tag" : "mobile"},
	    {"name" : "security",
    	"tag" : "security"},
	    {"name" : "social",
    	"tag" : "social"},
	    {"name" : "other",
    	"tag" : "other"}
    ];
    
    var updated = [];
    var allrepos = [];

    
    (function ($, undefined) {
    	
      var repoUrls = {
      };

      function repoUrl(repo) {
        return repoUrls[repo.name] || repo.html_url;
      }   
      
      function repoDescription(repo) {
        desc = repo.description;
        return desc;
      }
      
      function addUpdated()
      {
      	$("#updated").empty();
      	for (r=0; r < Math.min(4, updated.length); r++)
      	{
      		repo = updated[r];
	    	desc = repoDescription(repo);
	    	var $uitem = $("<div>").addClass("updated-card col-sm-5 col-md-4 col-lg-3");
	        var $item = $("<div>").addClass("card pin " + (repo.language || '').toLowerCase() + " "+repo.name.toLowerCase());
	        var $link = $("<a>").attr("href", repoUrl(repo)).appendTo($item);
	        $link.append($("<h4>").text(repo.name));
	        $link.append($("<h5>").text((repo.language != null) ? repo.language : ""));
	        $item.append($("<p>").text(desc));
	        $item.appendTo($uitem);
      		$uitem.appendTo("#updated");
      	}
      	
      	var d = $("#updated").collapse({
  			toggle: true
		});

      }
      
      function addAllRepos()
      {
      	$("#allrepos").empty();
      	
      	for (r=0; r < allrepos.length; r++)
      	{
      		repo = allrepos[r];
	    	desc = repoDescription(repo);
	        var $item = $("<div>").addClass("card pin col-sm-5 col-md-4 col-lg-3 " + (repo.language || '').toLowerCase() + " "+repo.name.toLowerCase());
	        var $link = $("<a>").attr("href", repoUrl(repo)).appendTo($item);
	        $link.append($("<h4>").html(repo.name + "<div class='org'><a href='"+repo.owner.html_url+"'>("+repo.owner.login+")"));
	        $link.append($("<h5>").text((repo.language != null) ? repo.language : ""));
	        $item.append($("<p>").text(desc));
	    	htag = "#allrepos";
			$item.appendTo(htag);
      	}
      	
      	$(".nrepos").text("("+allrepos.length+")");
      	
      	var d = $("#allrepos").collapse({
  			toggle: true
		});
      	
      }

      function pushRepo(repos, org) 
      {
      	var left = repos; var right = allrepos;
		var result  = [],
		        il      = 0,
		        ir      = 0;
		
		    while (il < left.length && ir < right.length){
		        if (left[il].name.toLowerCase() < right[ir].name.toLowerCase()){
		            result.push(left[il++]);
		        } else {
		            result.push(right[ir++]);
		        }
		    }
		
		    allrepos = result.concat(left.slice(il)).concat(right.slice(ir));
      }      
      
      function mergeUpdated(repos)
      {
      	var left = repos; var right = updated;
		var result  = [],
		        il      = 0,
		        ir      = 0;
		
		    while (il < left.length && ir < right.length){
		        if (left[il].pushed_at > right[ir].pushed_at){
		            result.push(left[il++]);
		        } else {
		            result.push(right[ir++]);
		        }
		    }
		
		    updated = result.concat(left.slice(il)).concat(right.slice(ir));
      }
      
      function incVal(tag)
      {
    		nrepos = $(tag).prev().find("span");
    		nrepoval = nrepos.text();
    		val = nrepoval.substring(1, nrepoval.length - 1);
    		nrepos.text("("+(parseInt(val)+1)+")");
      }

      function addRepos(orgs, repos, page) {
      	var org = orgs.name;
        repos = repos || [];
        page = page || 1;
        
       //var uri = "/data/"+org+".json";
	   // These client tokens are for a dummy app, and there is no user specific information that we get, so 
	   // all in all, pretty safe to expose this here.
       var uri = "https://api.github.com/"+orgs.type+"s/"+org+"/repos?callback=?"
                + "&per_page=100"
                + "&page="+page
                + "&client_id=1bafa09b6086eec7afb4"
                + "&client_secret=7e6422a0a2e24f0d0ecb7521a63990b5758c9cc8";

        $.getJSON(uri, function (result) {
          if (result.data && result.data.length > 0) {
            repos = repos.concat(result.data);
/*            addRepos(org,repos, page + 1);
          }
          else {*/
         	
         	/*
         	 * This logic is from twitter's github page found at twitter.github.io.
         	 * Thanks Twitter! Not really looking at correctness atm.
         	 */
            $(function () {
              $("#num-repos").text(repos.length);

              // Convert pushed_at to Date.
              $.each(repos, function (i, repo) {
                repo.pushed_at = new Date(repo.pushed_at);
                

                var weekHalfLife  = 1.146 * Math.pow(10, -9);

                var pushDelta    = (new Date) - Date.parse(repo.pushed_at);
                var createdDelta = (new Date) - Date.parse(repo.created_at);

                var weightForPush = 1;
                var weightForWatchers = 1.314 * Math.pow(10, 7);

                repo.hotness = weightForPush * Math.pow(Math.E, -1 * weekHalfLife * pushDelta);
                repo.hotness += weightForWatchers * repo.watchers / createdDelta;
              });
				console.log("before sort")
              // Sort by highest # of watchers.
              
              repos.sort(function (a, b) {
                if (a.pushed_at < b.pushed_at) return 1;
                if (b.pushed_at < a.pushed_at) return -1;
                return 0;
              });              
              
              console.log("after sort");
              
              mergeUpdated(repos);

              repos.sort(function (a, b) {
                if (a.name.toLowerCase() > b.name.toLowerCase()) {console.log(a.name+" > "+b.name);return 1;}
                if (b.name.toLowerCase() > a.name.toLowerCase()) {console.log(a.name+" < "+b.name);return -1};
                return 0;
              });
              //$.each(repos, function (i, repo) {
                pushRepo(repos, org);
              //});

              addUpdated();
              addAllRepos();

            });
          }
        });
      } 
      
	  	$("<div>").addClass("separator").appendTo("#wrapper");
	  	var $sectiontitle = $("<div>").addClass("section-title").appendTo("#wrapper");
  		var $title = $("<span>").addClass('title').text("recent").appendTo($sectiontitle);
  		var $item = $("<div id='updated'>").addClass("columns section collapse");
	  	$item.appendTo($sectiontitle);
  		var $twistie = $("<a data-toggle='collapse' data-target='#updated'>").addClass("twistie showdetails");
  		$twistie.appendTo($sectiontitle);
      
	  	$("<div>").addClass("separator gap").appendTo("#wrapper");
	  	var $sectiontitle = $("<div>").addClass("section-title").appendTo("#wrapper");
  		var $title = $("<span>").addClass('title').text("repos").appendTo($sectiontitle);
  		var $repos = $("<span>").addClass('nrepos').text("(0)").appendTo($title);
	  	var $item = $("<div id='allrepos'>").addClass("columns section collapse");
	  	$item.appendTo($sectiontitle);
  		var $twistie = $("<a data-toggle='collapse' data-target='#allrepos'>").addClass("twistie showdetails");
  		$twistie.appendTo($sectiontitle);

	  for (var r in orgs)
	  {
/*	  	current_org = orgs[r].name;
	  	$("<div>").addClass("separator").appendTo("#wrapper");
	  	var $sectiontitle = $("<div>").addClass("section-title").appendTo("#wrapper");
	  	if (orgs[r].link)
	  		var $title = $("<a href='"+orgs[r].link+"'>").addClass('title').text(""+current_org).appendTo($sectiontitle)
	  	else
	  		var $title = $("<span>").addClass('title').text(""+current_org).appendTo($sectiontitle)
	  	var themes = orgs[r].themes.split(" ")
	  	for (var t in themes)
	  	{
	  		//$sectiontitle.append($("<img src='images/"+themes[t]+".png' title='"+themes[t]+"'>").addClass("theme-image"));
	  	}
	  	var $item = $("<div id="+current_org+">").addClass("columns section");
	  	$item.appendTo("#wrapper");*/
	  	addRepos(orgs[r]);
	  }
	  
	  
      $("<div>").addClass("separator").appendTo("#wrapper");
      


    })(jQuery);
    
    $('#search').keyup(function() {
    var val = $.trim($(this).val()).replace(/ +/g, ' ').toLowerCase();
	$rows = $(".card")
    $rows.show().filter(function() {
        var text = $(this).text().replace(/\s+/g, ' ').toLowerCase();
        return !~text.indexOf(val);
    }).hide();
    $rows = $(".updated-card");
        $rows.show().filter(function() {
        var text = $(this).text().replace(/\s+/g, ' ').toLowerCase();
        return !~text.indexOf(val);
    }).hide();
});
    </script>


</body></html>
